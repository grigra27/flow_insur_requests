# Фикстуры для системы страховых заявок

Этот каталог содержит начальные данные (фикстуры) для системы управления страховыми заявками.

## Файлы фикстур

### initial_data.json
Содержит базовые данные для инициализации системы:
- Группы пользователей ("Администраторы" и "Пользователи")
- Пользователей по умолчанию (admin и user)

### sample_data.json
Содержит демонстрационные данные для тестирования и разработки:
- Группы пользователей и учетные записи
- 5 примеров страховых заявок с различными статусами
- Примеры всех типов страхования (КАСКО, спецтехника, имущество)
- Различные комбинации дополнительных параметров (франшиза, рассрочка, автозапуск, КАСКО C/E)
- Представлены разные филиалы

**Использование:**
```bash
# Создание и миграция базы данных
python manage.py migrate

# Загрузка демонстрационных данных
python manage.py loaddata insurance_requests/fixtures/sample_data.json
```

**Тестовые учетные записи:**
- **Администратор**: логин: `admin`, пароль: `admin123`
- **Пользователь**: логин: `user`, пароль: `user123`

**Примеры заявок в sample_data.json:**
1. **ДФА-2025-001** - КАСКО с франшизой и автозапуском (письмо сгенерировано)
2. **ДФА-2025-002** - Страхование спецтехники с рассрочкой (загружена)
3. **ДФА-2025-003** - КАСКО категории C/E с франшизой и рассрочкой (письмо отправлено)
4. **ДФА-2025-004** - Страхование имущества (завершена)
5. **ДФА-2025-005** - КАСКО с ошибкой для тестирования обработки ошибок

⚠️ **Важно**: Все данные в sample_data.json являются вымышленными и созданы для демонстрации функциональности системы.

## Команды управления

### setup_initial_data
Основная команда для полной настройки системы:
```bash
python manage.py setup_initial_data
```

Опции:
- `--admin-username` - имя администратора (по умолчанию: admin)
- `--admin-password` - пароль администратора (по умолчанию: admin123)
- `--admin-email` - email администратора
- `--skip-test-user` - не создавать тестового пользователя
- `--use-fixtures` - использовать фикстуры для создания пользователей
- `--force-fixtures` - принудительно пересоздать пользователей из фикстур

### create_default_users
Создает пользователей по умолчанию:
```bash
python manage.py create_default_users --create-test-user
```

Опции:
- `--admin-username` - имя администратора
- `--admin-password` - пароль администратора
- `--admin-email` - email администратора
- `--create-test-user` - создать тестового пользователя
- `--test-username` - имя тестового пользователя
- `--test-password` - пароль тестового пользователя

### load_initial_fixtures
Загружает фикстуры и создает пользователей:
```bash
python manage.py load_initial_fixtures
```

Опции:
- `--force` - принудительно пересоздать данные
- `--admin-password` - пароль для администратора
- `--user-password` - пароль для тестового пользователя

### setup_user_groups
Создает группы пользователей и настраивает разрешения:
```bash
python manage.py setup_user_groups
```

## Группы пользователей

### Администраторы
- Полный доступ ко всем функциям системы
- Права суперпользователя
- Доступ к Django Admin
- Управление пользователями

### Пользователи
- Доступ к основным функциям работы с заявками
- Просмотр, создание и редактирование заявок
- Работа с вложениями
- Просмотр ответов на заявки

## Пользователи по умолчанию

### admin
- Логин: admin
- Пароль: admin123 (по умолчанию)
- Группа: Администраторы
- Права: Суперпользователь

### user
- Логин: user
- Пароль: user123 (по умолчанию)
- Группа: Пользователи
- Права: Обычный пользователь

## Примеры использования

### Полная настройка системы
```bash
python manage.py setup_initial_data
```

### Создание кастомного администратора
```bash
python manage.py create_default_users \
    --admin-username myAdmin \
    --admin-password mySecurePassword123 \
    --admin-email admin@mycompany.com
```

### Пересоздание пользователей из фикстур
```bash
python manage.py load_initial_fixtures --force --admin-password newPassword123
```

### Только настройка групп и разрешений
```bash
python manage.py setup_user_groups
```

## Безопасность

⚠️ **Важно**: В продакшене обязательно измените пароли по умолчанию!

Рекомендации:
1. Используйте сложные пароли для администраторов
2. Регулярно обновляйте пароли
3. Удалите тестовых пользователей в продакшене
4. Настройте правильные email адреса для уведомлений