# Timeweb HTTPS Deployment Environment Configuration
# This template contains all necessary environment variables for Timeweb deployment
# Copy this file to .env and update the values according to your deployment needs

# =============================================================================
# BASIC DJANGO CONFIGURATION
# =============================================================================

# Django Secret Key - MUST be changed for production
# Generate a new key: python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
SECRET_KEY=your-timeweb-django-secret-key-minimum-50-characters-long-change-this

# Debug mode - MUST be False for production
DEBUG=False

# Docker image to use for deployment
DOCKER_IMAGE=ghcr.io/grigra27/flow_insur_requests:timeweb-latest

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL database settings
DB_ENGINE=django.db.backends.postgresql
DB_NAME=insflow_db
DB_USER=insflow_user
DB_PASSWORD=secure-timeweb-database-password-change-this
DB_HOST=db
DB_PORT=5432

# =============================================================================
# DOMAIN CONFIGURATION
# =============================================================================

# All allowed hosts (domains and IP addresses)
# Include all domains that will access the application
ALLOWED_HOSTS=insflow.ru,zs.insflow.ru,insflow.tw1.su,zs.insflow.tw1.su,80.90.189.37

# Main domains for the application
MAIN_DOMAINS=insflow.ru,insflow.tw1.su

# Subdomains for the application
SUBDOMAINS=zs.insflow.ru,zs.insflow.tw1.su

# All domains for SSL certificate generation (comma-separated)
DOMAINS=insflow.ru,zs.insflow.ru,insflow.tw1.su,zs.insflow.tw1.su

# =============================================================================
# HTTPS SECURITY CONFIGURATION
# =============================================================================

# Enable HTTPS functionality
ENABLE_HTTPS=True

# Force SSL redirect (redirect HTTP to HTTPS)
SECURE_SSL_REDIRECT=True
SSL_REDIRECT=True

# HTTP Strict Transport Security (HSTS) settings
SECURE_HSTS_SECONDS=31536000
HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True

# Cookie security settings (automatically configured based on ENABLE_HTTPS)
SESSION_COOKIE_SECURE=True
CSRF_COOKIE_SECURE=True
SECURE_COOKIES=True

# Cookie SameSite policy
SESSION_COOKIE_SAMESITE=Lax
CSRF_COOKIE_SAMESITE=Lax

# Additional HTTPS security headers
SECURE_REFERRER_POLICY=strict-origin-when-cross-origin
SECURE_CROSS_ORIGIN_OPENER_POLICY=same-origin

# =============================================================================
# SSL CERTIFICATE CONFIGURATION
# =============================================================================

# Email for Let's Encrypt certificate registration
SSL_EMAIL=admin@insflow.ru

# Use Let's Encrypt staging environment for testing (set to 'true' for testing)
CERTBOT_STAGING=false

# SSL certificate storage configuration
# Options: 'volume' (default, recommended) or 'bind' (for production with persistent storage)
SSL_VOLUME_TYPE=volume
ACME_VOLUME_TYPE=volume

# SSL certificate paths (only used when SSL_VOLUME_TYPE=bind)
# Uncomment and set these paths if using bind mounts:
# SSL_CERTIFICATES_PATH=/opt/insflow-system/letsencrypt
# ACME_CHALLENGE_PATH=/opt/insflow-system/acme-challenge

# =============================================================================
# CSRF PROTECTION CONFIGURATION
# =============================================================================

# CSRF trusted origins (auto-generated from ALLOWED_HOSTS if not specified)
# Uncomment to manually specify:
# CSRF_TRUSTED_ORIGINS=https://insflow.ru,https://zs.insflow.ru,https://insflow.tw1.su,https://zs.insflow.tw1.su

# =============================================================================
# CONTENT SECURITY POLICY (CSP) CONFIGURATION
# =============================================================================

# Basic CSP settings for security
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline'
CSP_STYLE_SRC='self' 'unsafe-inline'
CSP_IMG_SRC='self' data:
CSP_FONT_SRC='self'
CSP_CONNECT_SRC='self'
CSP_FRAME_ANCESTORS='none'

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Enable HTTPS-specific logging
HTTPS_LOGGING_ENABLED=True

# =============================================================================
# STATIC AND MEDIA FILES CONFIGURATION
# =============================================================================

# Static files URL path
STATIC_URL=/static/

# Media files URL path
MEDIA_URL=/media/

# =============================================================================
# SESSION CONFIGURATION
# =============================================================================

# Session cookie names for HTTPS (optional customization)
# SESSION_COOKIE_NAME=sessionid_secure
# CSRF_COOKIE_NAME=csrftoken_secure

# =============================================================================
# ADVANCED CONFIGURATION (Optional)
# =============================================================================

# Secure redirect exemptions (paths that don't require HTTPS redirect)
# SECURE_REDIRECT_EXEMPT=

# Custom session timeout (default: 3600 seconds = 1 hour)
# SESSION_COOKIE_AGE=3600

# =============================================================================
# DEPLOYMENT NOTES
# =============================================================================

# 1. Change SECRET_KEY and DB_PASSWORD before deployment
# 2. Verify all domains in ALLOWED_HOSTS and DOMAINS are correct
# 3. Set SSL_EMAIL to a valid email address for certificate notifications
# 4. For production, consider using bind mounts for SSL certificates
# 5. Test with CERTBOT_STAGING=true first, then set to false for production
# 6. Ensure all domains point to your server before certificate generation